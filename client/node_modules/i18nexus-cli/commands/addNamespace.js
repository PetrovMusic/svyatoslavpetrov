const colors = require('colors');
const handleError = require('../handleError');
const handleFetch = require('../handleFetch');
const baseUrl = require('../baseUrl');

const addNamespace = async opt => {
  let url = `${baseUrl}/project_resources/namespaces.json`;

  url += `?api_key=${opt.apiKey}`;

  const response = await handleFetch(url, {
    method: 'POST',
    body: JSON.stringify({
      title: opt.title
    }),
    headers: {
      Authorization: `Bearer ${opt.pat}`,
      'Content-Type': 'application/json'
    }
  });

  if (response.status !== 200) {
    return handleError(response);
  }

  await response.json();

  console.log(colors.green(`New namespace added: "${opt.title}"`));
};

module.exports = addNamespace;
